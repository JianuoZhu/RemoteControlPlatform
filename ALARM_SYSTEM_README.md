# 报警系统使用说明

## 功能概述

本报警系统为机器人监控平台提供了完整的紧急情况报警功能，包括：

1. **用户配置管理** - 管理个人信息和紧急联系人
2. **紧急报警触发** - 模拟紧急情况报警
3. **多渠道通知** - 支持邮件、短信、推送通知
4. **报警状态管理** - 查看和处理报警记录

## 主要功能

### 1. 用户配置页面 (`/user-settings`)

- **个人信息管理**
  - 姓名、手机号码、邮箱地址
  - 通知偏好设置（邮件、短信、推送）

- **紧急联系人管理**
  - 添加、编辑、删除紧急联系人
  - 设置主要联系人
  - 支持多种关系类型（配偶、子女、父母等）

- **测试功能**
  - 测试紧急通知发送功能

### 2. Dashboard 紧急报警

- **紧急报警按钮**
  - 位于Dashboard页面右上角
  - 点击触发模拟紧急情况报警
  - 支持确认对话框防止误触

- **报警状态显示**
  - 显示报警系统运行状态
  - 实时监控系统状态

### 3. 后端API支持

#### 用户配置API
- `GET /user/profile` - 获取用户配置
- `PATCH /user/profile` - 更新用户配置
- `POST /user/emergency-contacts` - 添加紧急联系人
- `PATCH /user/emergency-contacts/{id}` - 更新紧急联系人
- `DELETE /user/emergency-contacts/{id}` - 删除紧急联系人

#### 紧急报警API
- `POST /emergency/trigger` - 触发紧急报警
- `GET /emergency/alerts` - 获取报警列表
- `PATCH /emergency/alerts/{id}/acknowledge` - 确认报警
- `POST /emergency/test-notification` - 测试通知

## 使用方法

### 1. 配置用户信息

1. 点击侧边栏的"用户配置"进入配置页面
2. 填写个人信息（姓名、手机、邮箱）
3. 设置通知偏好
4. 添加紧急联系人

### 2. 测试报警功能

1. 在Dashboard页面点击"紧急报警"按钮
2. 确认触发报警
3. 系统会自动发送通知给配置的联系人

### 3. 测试通知功能

1. 在用户配置页面点击"测试紧急通知"按钮
2. 系统会模拟发送通知

## 报警类型

系统支持以下紧急情况类型：

- **emergency_fall** - 老人摔倒报警
- **emergency_heart_rate** - 心率异常报警
- **emergency_other** - 其他紧急情况

## 通知方式

- **邮件通知** - 发送到用户和紧急联系人的邮箱
- **短信通知** - 发送到用户和紧急联系人的手机
- **推送通知** - 应用内推送通知（预留功能）

## 技术实现

### 前端技术栈
- React + TypeScript
- Flowbite React UI组件库
- Axios HTTP客户端

### 后端技术栈
- FastAPI (Python)
- Pydantic 数据验证
- 模拟数据存储（可扩展为数据库）

### 数据模型
- `UserProfile` - 用户配置信息
- `EmergencyContact` - 紧急联系人
- `EmergencyAlert` - 紧急报警记录

## 扩展功能

### 1. 真实通知集成
- 集成邮件服务（如SMTP、SendGrid）
- 集成短信服务（如阿里云短信、腾讯云短信）
- 集成推送服务（如Firebase、极光推送）

### 2. 数据库存储
- 使用PostgreSQL或MySQL存储用户配置
- 使用Redis缓存报警状态
- 实现数据持久化

### 3. 实时监控
- WebSocket实时推送报警信息
- 报警状态实时更新
- 在线状态监控

### 4. 报警规则配置
- 自定义报警阈值
- 报警规则管理
- 报警级别设置

## 注意事项

1. 当前版本使用模拟数据，生产环境需要集成真实的通知服务
2. 紧急报警功能仅用于测试，实际使用需要谨慎
3. 用户信息需要妥善保护，建议加密存储
4. 建议添加用户认证和权限控制

## 开发说明

### 启动开发环境

```bash
# 启动后端服务
cd backend
python main.py

# 启动前端服务
npm run dev
```

### API文档

启动后端服务后，访问 `http://localhost:8000/docs` 查看完整的API文档。 